{
    "$defs": {
        "Check": {
            "additionalProperties": false,
            "properties": {
                "Check": {
                    "$ref": "#/$defs/CheckItem"
                }
            },
            "required": [
                "Check"
            ],
            "type": "object"
        },
        "CheckItem": {
            "oneOf": [
                {
                    "additionalProperties": false,
                    "properties": {
                        "all": {
                            "$ref": "#/$defs/CheckList"
                        }
                    },
                    "required": [
                        "all"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "any": {
                            "$ref": "#/$defs/CheckList"
                        }
                    },
                    "required": [
                        "any"
                    ],
                    "type": "object"
                }
            ]
        },
        "CheckList": {
            "items": {
                "anyOf": [
                    {
                        "$ref": "#/$defs/CheckItem"
                    },
                    {
                        "$ref": "#/$defs/Operator"
                    }
                ]
            },
            "type": "array"
        },
        "Classes": {
            "items": {
                "enum": [
                    "All",
                    "Events",
                    "Findings",
                    "Findings About",
                    "General Observations",
                    "Interventions",
                    "Relationship",
                    "Special-Purpose",
                    "Study Reference",
                    "Trial Design"
                ],
                "type": "string"
            },
            "type": "array"
        },
        "Domain": {
            "pattern": "^(All|RELREC|RELSUB|SUPP|[A-Z]{2})$",
            "type": "string"
        },
        "Domains": {
            "items": {
                "$ref": "#/$defs/Domain"
            },
            "type": "array"
        },
        "Operation": {
            "items": {
                "$ref": "#/$defs/Operator"
            },
            "type": "array"
        },
        "Operator": {
            "additionalProperties": false,
            "properties": {
                "context": {
                    "type": "string"
                },
                "date_component": {
                    "enum": [
                        "year",
                        "month",
                        "day",
                        "hour",
                        "minute",
                        "second",
                        "microsecond"
                    ],
                    "type": "string"
                },
                "name": {
                    "anyOf": [
                        {
                            "enum": [
                                "dataset_label",
                                "dataset_location",
                                "dataset_name",
                                "dataset_size",
                                "variable_data_type",
                                "variable_label",
                                "variable_name",
                                "variable_role",
                                "variable_size"
                            ],
                            "type": "string"
                        },
                        {
                            "$ref": "#/$defs/VariableName"
                        }
                    ]
                },
                "operator": {
                    "enum": [
                        "comformant_value_data_type",
                        "comformant_value_length",
                        "contains",
                        "contains_all",
                        "contains_case_insensitive",
                        "date_equal_to",
                        "date_greater_than",
                        "date_greater_than_or_equal_to",
                        "date_less_than",
                        "date_less_than_or_equal_to",
                        "date_not_equal_to",
                        "does_not_contain",
                        "does_not_contain_case_insensitive",
                        "does_not_have_next_corresponding_record",
                        "empty",
                        "empty_within_except_last_row",
                        "ends_with",
                        "equal_to",
                        "equal_to_case_insensitive",
                        "exists",
                        "greater_than",
                        "greater_than_or_equal_to",
                        "has_equal_length",
                        "has_next_corresponding_record",
                        "has_not_equal_length",
                        "invalid_date",
                        "is_complete_date",
                        "is_contained_by",
                        "is_contained_by_case_insensitive",
                        "is_false",
                        "is_incomplete_date",
                        "is_not_contained_by",
                        "is_not_contained_by_case_insensitive",
                        "is_not_ordered_set",
                        "is_not_unique_relationship",
                        "is_not_unique_set",
                        "is_not_valid_reference",
                        "is_not_valid_relationship",
                        "is_ordered_set",
                        "is_true",
                        "is_unique_relationship",
                        "is_unique_set",
                        "is_valid_reference",
                        "is_valid_relationship",
                        "less_than",
                        "less_than_or_equal_to",
                        "longer_than",
                        "longer_than_or_equal_to",
                        "matches_regex",
                        "non_comformant_value_data_type",
                        "non_comformant_value_length",
                        "non_empty",
                        "non_empty_within_except_last_row",
                        "not_contains_all",
                        "not_equal_to",
                        "not_equal_to_case_insensitive",
                        "not_exists",
                        "not_matches_regex",
                        "not_prefix_matches_regex",
                        "not_present_on_multiple_rows_within",
                        "not_suffix_matches_regex",
                        "num_equal_to",
                        "num_not_equal_to",
                        "prefix_matches_regex",
                        "present_on_multiple_rows_within",
                        "shares_at_least_one_element_with",
                        "shares_exactly_one_element_with",
                        "shares_no_elements_with",
                        "shorter_than",
                        "shorter_than_or_equal_to",
                        "starts_with",
                        "str_equal_to",
                        "str_not_equal_to",
                        "suffix_matches_regex"
                    ],
                    "type": "string"
                },
                "prefix": {
                    "type": "integer"
                },
                "suffix": {
                    "type": "integer"
                },
                "value": {
                    "type": [
                        "number",
                        "string"
                    ]
                },
                "value_is_literal": {
                    "type": "boolean",
                    "enum": [
                        true
                    ]
                }
            },
            "required": [
                "name",
                "operator"
            ],
            "type": "object"
        },
        "VariableName": {
            "pattern": "^--[A-Z]{1,6}|[A-Z]{1,8}$",
            "type": "string"
        }
    },
    "$id": "https://cdisc.org/rules/1-0",
    "additionalProperties": false,
    "description": "Validation schema CDISC Rules 1.0",
    "properties": {
        "Authority": {
            "additionalProperties": false,
            "properties": {
                "Organization": {
                    "enum": [
                        "CDISC"
                    ],
                    "type": "string"
                }
            },
            "required": [
                "Organization"
            ],
            "type": "object"
        },
        "Citations": {
            "items": {
                "additionalProperties": false,
                "properties": {
                    "Cited Guidance": {
                        "type": "string"
                    },
                    "Document": {
                        "type": "string"
                    },
                    "Item": {
                        "type": "string"
                    },
                    "Section": {
                        "type": "string"
                    }
                },
                "required": [
                    "Document",
                    "Section",
                    "Cited Guidance"
                ],
                "type": "object"
            },
            "type": "array"
        },
        "Core": {
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "pattern": "^.+$",
                    "type": "string"
                },
                "Version": {
                    "enum": [
                        "1"
                    ],
                    "type": "string"
                }
            },
            "required": [
                "Id",
                "Version"
            ],
            "type": "object"
        },
        "Description": {
            "type": "string"
        },
        "Operations": {
            "items": {
                "additionalProperties": false,
                "properties": {
                    "domain": {
                        "$ref": "#/$defs/Domain"
                    },
                    "id": {
                        "pattern": "^\\$.+$",
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "operator": {
                        "enum": [
                            "distinct",
                            "dy",
                            "max",
                            "max_date",
                            "mean",
                            "min",
                            "min_date"
                        ],
                        "type": "string"
                    }
                },
                "required": [
                    "domain",
                    "id",
                    "name",
                    "operator"
                ],
                "type": "object"
            },
            "type": "array"
        },
        "Outcome": {
            "additionalProperties": false,
            "properties": {
                "Message": {
                    "type": "string"
                },
                "Output Variable": {
                    "items": {
                        "$ref": "#/$defs/VariableName"
                    },
                    "type": "array"
                }
            },
            "required": [
                "Message"
            ],
            "type": "object"
        },
        "Reference": {
            "additionalProperties": false,
            "properties": {
                "Origin": {
                    "type": "string"
                },
                "Rule Identifier": {
                    "additionalProperties": false,
                    "properties": {
                        "Id": {
                            "type": "string"
                        },
                        "Version": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "Id",
                        "Version"
                    ],
                    "type": "object"
                },
                "Version": {
                    "type": "string"
                }
            },
            "required": [
                "Origin",
                "Rule Identifier",
                "Version"
            ],
            "type": "object"
        },
        "Rule Type": {
            "oneOf": [
                {
                    "additionalProperties": false,
                    "properties": {
                        "Consistency": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Consistency"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Data Domain aggregation": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Data Domain aggregation"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Data Pattern and Format": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Data Pattern and Format"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Dataset Metadata Check": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Dataset Metadata Check"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Dataset Metadata Check against Define XML": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Dataset Metadata Check against Define XML"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Date Arithmetic": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Date Arithmetic"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Define-XML": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Define-XML"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Domain Existence Check": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Domain Existence Check"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "External Dictionaries": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "External Dictionaries"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Functional Dependency": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Functional Dependency"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Populated Values": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Populated Values"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Range & Limit": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Range & Limit"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Relationship Integrity Check": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Relationship Integrity Check"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Uniqueness": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Uniqueness"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Value Level Metadata Check against Define XML": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Value Level Metadata Check against Define XML"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Value Presence": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Value Presence"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Variable Length": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Variable Length"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Variable Metadata Check": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Variable Metadata Check"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Variable Metadata Check against Define XML": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Variable Metadata Check against Define XML"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Variable Order": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Variable Order"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "Variable Presence": {
                            "$ref": "#/$defs/Check"
                        }
                    },
                    "required": [
                        "Variable Presence"
                    ],
                    "type": "object"
                }
            ]
        },
        "Scopes": {
            "additionalProperties": false,
            "properties": {
                "Classes": {
                    "oneOf": [
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Include": {
                                    "$ref": "#/$defs/Classes"
                                }
                            },
                            "required": [
                                "Include"
                            ],
                            "type": "object"
                        },
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Exclude": {
                                    "$ref": "#/$defs/Classes"
                                }
                            },
                            "required": [
                                "Exclude"
                            ],
                            "type": "object"
                        }
                    ]
                },
                "Domains": {
                    "oneOf": [
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Include": {
                                    "$ref": "#/$defs/Domains"
                                }
                            },
                            "required": [
                                "Include"
                            ],
                            "type": "object"
                        },
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Exclude": {
                                    "$ref": "#/$defs/Domains"
                                }
                            },
                            "required": [
                                "Exclude"
                            ],
                            "type": "object"
                        }
                    ]
                },
                "Standards": {
                    "items": {
                        "additionalProperties": false,
                        "properties": {
                            "Name": {
                                "type": "string"
                            },
                            "Version": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "Name",
                            "Version"
                        ],
                        "type": "object"
                    },
                    "type": "array"
                }
            },
            "required": [
                "Standards",
                "Classes",
                "Domains"
            ],
            "type": "object"
        },
        "Sensitivity": {
            "enum": [
                "Study",
                "Class",
                "Domain",
                "Dataset",
                "Variable",
                "Code_list",
                "Term",
                "Record",
                "Value"
            ],
            "type": "string"
        },
        "Severity": {
            "enum": [
                "Error",
                "Notice",
                "Reject",
                "Warning"
            ],
            "type": "string"
        }
    },
    "required": [
        "Authority",
        "Citations",
        "Core",
        "Description",
        "Outcome",
        "Reference",
        "Rule Type",
        "Scopes",
        "Sensitivity",
        "Severity"
    ],
    "type": "object"
}
