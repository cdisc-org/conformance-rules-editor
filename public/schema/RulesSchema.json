{
    "$defs": {
        "CheckItem": {
            "oneOf": [
                {
                    "additionalProperties": false,
                    "properties": {
                        "all": {
                            "$ref": "#/$defs/CheckList"
                        }
                    },
                    "required": [
                        "all"
                    ],
                    "type": "object"
                },
                {
                    "additionalProperties": false,
                    "properties": {
                        "any": {
                            "$ref": "#/$defs/CheckList"
                        }
                    },
                    "required": [
                        "any"
                    ],
                    "type": "object"
                }
            ]
        },
        "CheckList": {
            "items": {
                "anyOf": [
                    {
                        "$ref": "#/$defs/CheckItem"
                    },
                    {
                        "$ref": "#/$defs/Operator"
                    }
                ]
            },
            "type": "array"
        },
        "Classes": {
            "items": {
                "enum": [
                    "All",
                    "Events",
                    "Findings",
                    "Findings About",
                    "Interventions",
                    "Relationship",
                    "Special-Purpose",
                    "Study Reference",
                    "Trial Design"
                ],
                "type": "string"
            },
            "type": "array"
        },
        "Dataset": {
            "pattern": "^(All|AP--|RELREC|RELSPEC|RELSUB|[A-Z]{2}|[A-Z]{4}|SUPP[A-Z]{2}|SUPP[A-Z]{4}|SQAP[A-Z]{4}|SUPP--)$",
            "type": "string"
        },
        "Domains": {
            "items": {
                "$ref": "#/$defs/Dataset"
            },
            "type": "array"
        },
        "Operation": {
            "items": {
                "$ref": "#/$defs/Operator"
            },
            "type": "array"
        },
        "OperationId": {
            "pattern": "^\\$.+$",
            "type": "string"
        },
        "Operator": {
            "additionalProperties": false,
            "properties": {
                "context": {
                    "type": "string"
                },
                "date_component": {
                    "enum": [
                        "year",
                        "month",
                        "day",
                        "hour",
                        "minute",
                        "second",
                        "microsecond"
                    ],
                    "type": "string"
                },
                "name": {
                    "anyOf": [
                        {
                            "enum": [
                                "dataset_label",
                                "dataset_location",
                                "dataset_name",
                                "dataset_size",
                                "define_variable_allowed_terms",
                                "define_variable_ccode",
                                "define_variable_data_type",
                                "define_variable_format",
                                "define_variable_label",
                                "define_variable_name",
                                "define_variable_origin_type",
                                "define_variable_role",
                                "define_variable_size",
                                "variable_data_type",
                                "variable_label",
                                "variable_name",
                                "variable_order",
                                "variable_size"
                            ],
                            "type": "string"
                        },
                        {
                            "$ref": "#/$defs/VariableName"
                        }
                    ]
                },
                "operator": {
                    "enum": [
                        "additional_columns_empty",
                        "additional_columns_not_empty",
                        "comformant_value_data_type",
                        "comformant_value_length",
                        "contains",
                        "contains_all",
                        "contains_case_insensitive",
                        "date_equal_to",
                        "date_greater_than",
                        "date_greater_than_or_equal_to",
                        "date_less_than",
                        "date_less_than_or_equal_to",
                        "date_not_equal_to",
                        "does_not_contain",
                        "does_not_contain_case_insensitive",
                        "does_not_have_next_corresponding_record",
                        "does_not_reference_correct_codelist",
                        "does_not_use_valid_codelist_terms",
                        "empty",
                        "empty_within_except_last_row",
                        "ends_with",
                        "equal_to",
                        "equal_to_case_insensitive",
                        "exists",
                        "greater_than",
                        "greater_than_or_equal_to",
                        "has_different_values",
                        "has_equal_length",
                        "has_next_corresponding_record",
                        "has_not_equal_length",
                        "has_same_values",
                        "invalid_date",
                        "is_complete_date",
                        "is_contained_by",
                        "is_contained_by_case_insensitive",
                        "is_false",
                        "is_incomplete_date",
                        "is_not_contained_by",
                        "is_not_contained_by_case_insensitive",
                        "is_not_ordered_set",
                        "is_not_unique_relationship",
                        "is_not_unique_set",
                        "is_not_valid_reference",
                        "is_not_valid_relationship",
                        "is_ordered_set",
                        "is_true",
                        "is_unique_relationship",
                        "is_unique_set",
                        "is_valid_reference",
                        "is_valid_relationship",
                        "less_than",
                        "less_than_or_equal_to",
                        "longer_than",
                        "longer_than_or_equal_to",
                        "matches_regex",
                        "non_comformant_value_data_type",
                        "non_comformant_value_length",
                        "non_empty",
                        "non_empty_within_except_last_row",
                        "not_contains_all",
                        "not_equal_to",
                        "not_equal_to_case_insensitive",
                        "not_exists",
                        "not_matches_regex",
                        "not_prefix_matches_regex",
                        "not_present_on_multiple_rows_within",
                        "not_suffix_matches_regex",
                        "num_equal_to",
                        "num_not_equal_to",
                        "prefix_matches_regex",
                        "present_on_multiple_rows_within",
                        "references_correct_codelist",
                        "shares_at_least_one_element_with",
                        "shares_exactly_one_element_with",
                        "shares_no_elements_with",
                        "shorter_than",
                        "shorter_than_or_equal_to",
                        "starts_with",
                        "str_equal_to",
                        "str_not_equal_to",
                        "suffix_matches_regex",
                        "uses_valid_codelist_terms"
                    ],
                    "type": "string"
                },
                "prefix": {
                    "type": "integer"
                },
                "suffix": {
                    "type": "integer"
                },
                "value": {
                    "oneOf": [
                        {
                            "type": [
                                "number",
                                "string"
                            ]
                        },
                        {
                            "items": {
                                "type": [
                                    "number"
                                ]
                            },
                            "type": "array"
                        },
                        {
                            "items": {
                                "type": [
                                    "string"
                                ]
                            },
                            "type": "array"
                        }
                    ]
                },
                "value_is_literal": {
                    "const": true
                }
            },
            "required": [
                "name",
                "operator"
            ],
            "type": "object"
        },
        "VariableName": {
            "pattern": "^(--[A-Z]{1,6}|[A-Z]{1,8})$",
            "type": "string"
        }
    },
    "$id": "https://cdisc.org/rules/1-0",
    "additionalProperties": false,
    "description": "Validation schema CDISC Rules 1.0",
    "properties": {
        "Authority": {
            "additionalProperties": false,
            "properties": {
                "Organization": {
                    "const": "CDISC"
                }
            },
            "required": [
                "Organization"
            ],
            "type": "object"
        },
        "Check": {
            "$ref": "#/$defs/CheckItem"
        },
        "Citations": {
            "items": {
                "additionalProperties": false,
                "properties": {
                    "Cited Guidance": {
                        "type": "string"
                    },
                    "Document": {
                        "type": "string"
                    },
                    "Item": {
                        "type": "string"
                    },
                    "Section": {
                        "type": "string"
                    }
                },
                "required": [
                    "Document",
                    "Section",
                    "Cited Guidance"
                ],
                "type": "object"
            },
            "type": "array"
        },
        "Core": {
            "additionalProperties": false,
            "properties": {
                "Id": {
                    "pattern": "^CDISC\\.SDTMIG\\.CG\\d{4}$",
                    "type": "string"
                },
                "Version": {
                    "const": "1"
                }
            },
            "required": [
                "Id",
                "Version"
            ],
            "type": "object"
        },
        "Description": {
            "type": "string"
        },
        "Match Datasets": {
            "items": {
                "additionalProperties": false,
                "properties": {
                    "Name": {
                        "$ref": "#/$defs/Dataset"
                    },
                    "Is Relationship": {
                        "const": true
                    },
                    "Keys": {
                        "items": {
                            "$ref": "#/$defs/VariableName"
                        },
                        "type": "array"
                    }
                },
                "required": [
                    "Name",
                    "Keys"
                ],
                "type": "object"
            },
            "type": "array"
        },
        "Operations": {
            "items": {
                "additionalProperties": false,
                "properties": {
                    "domain": {
                        "$ref": "#/$defs/Dataset"
                    },
                    "group": {
                        "items": {
                            "$ref": "#/$defs/VariableName"
                        },
                        "type": "array"
                    },
                    "id": {
                        "$ref": "#/$defs/OperationId"
                    },
                    "name": {
                        "type": "string"
                    },
                    "operator": {
                        "enum": [
                            "distinct",
                            "dy",
                            "max",
                            "max_date",
                            "mean",
                            "min",
                            "min_date"
                        ],
                        "type": "string"
                    }
                },
                "required": [
                    "domain",
                    "id",
                    "name",
                    "operator"
                ],
                "type": "object"
            },
            "type": "array"
        },
        "Outcome": {
            "additionalProperties": false,
            "properties": {
                "Message": {
                    "type": "string"
                },
                "Output Variables": {
                    "items": {
                        "oneOf": [
                            {
                                "$ref": "#/$defs/OperationId"
                            },
                            {
                                "$ref": "#/$defs/VariableName"
                            }
                        ]
                    },
                    "type": "array"
                }
            },
            "required": [
                "Message"
            ],
            "type": "object"
        },
        "References": {
            "items": {
                "additionalProperties": false,
                "properties": {
                    "Origin": {
                        "const": "SDTM and SDTMIG Conformance Rules"
                    },
                    "Rule Identifier": {
                        "additionalProperties": false,
                        "properties": {
                            "Id": {
                                "type": "string"
                            },
                            "Version": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "Id",
                            "Version"
                        ],
                        "type": "object"
                    },
                    "Version": {
                        "const": "2.0"
                    }
                },
                "required": [
                    "Origin",
                    "Rule Identifier",
                    "Version"
                ],
                "type": "object"
            },
            "minItems": 1,
            "type": "array"
        },
        "Rule Type": {
            "oneOf": [
                {
                    "const": "Consistency"
                },
                {
                    "const": "Data Domain aggregation"
                },
                {
                    "const": "Data Pattern and Format"
                },
                {
                    "const": "Dataset Metadata Check"
                },
                {
                    "const": "Dataset Metadata Check against Define XML"
                },
                {
                    "const": "Date Arithmetic"
                },
                {
                    "const": "Define-XML"
                },
                {
                    "const": "Domain Presence Check"
                },
                {
                    "const": "External Dictionaries"
                },
                {
                    "const": "Functional Dependency"
                },
                {
                    "const": "Populated Values"
                },
                {
                    "const": "Range & Limit"
                },
                {
                    "const": "Relationship Integrity Check"
                },
                {
                    "const": "Uniqueness"
                },
                {
                    "const": "Value Level Metadata Check against Define XML"
                },
                {
                    "const": "Value Presence"
                },
                {
                    "const": "Variable Length"
                },
                {
                    "const": "Variable Metadata Check"
                },
                {
                    "const": "Variable Metadata Check against Define XML"
                },
                {
                    "const": "Variable Order"
                },
                {
                    "const": "Variable Presence"
                }
            ]
        },
        "Scopes": {
            "additionalProperties": false,
            "properties": {
                "Classes": {
                    "oneOf": [
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Include": {
                                    "$ref": "#/$defs/Classes"
                                }
                            },
                            "required": [
                                "Include"
                            ],
                            "type": "object"
                        },
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Exclude": {
                                    "$ref": "#/$defs/Classes"
                                }
                            },
                            "required": [
                                "Exclude"
                            ],
                            "type": "object"
                        }
                    ]
                },
                "Domains": {
                    "oneOf": [
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Include": {
                                    "$ref": "#/$defs/Domains"
                                }
                            },
                            "required": [
                                "Include"
                            ],
                            "type": "object"
                        },
                        {
                            "additionalProperties": false,
                            "properties": {
                                "Exclude": {
                                    "$ref": "#/$defs/Domains"
                                }
                            },
                            "required": [
                                "Exclude"
                            ],
                            "type": "object"
                        }
                    ]
                },
                "Standards": {
                    "items": {
                        "additionalProperties": false,
                        "properties": {
                            "Name": {
                                "type": "string"
                            },
                            "Version": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "Name",
                            "Version"
                        ],
                        "type": "object"
                    },
                    "type": "array"
                }
            },
            "required": [
                "Standards",
                "Classes",
                "Domains"
            ],
            "type": "object"
        },
        "Sensitivity": {
            "enum": [
                "Study",
                "Class",
                "Domain",
                "Dataset",
                "Variable",
                "Code_list",
                "Term",
                "Record",
                "Value"
            ],
            "type": "string"
        },
        "Severity": {
            "enum": [
                "Error",
                "Notice",
                "Reject",
                "Warning"
            ],
            "type": "string"
        }
    },
    "required": [
        "Authority",
        "Check",
        "Citations",
        "Core",
        "Description",
        "Outcome",
        "References",
        "Rule Type",
        "Scopes",
        "Sensitivity",
        "Severity"
    ],
    "type": "object"
}
